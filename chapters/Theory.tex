\chapter{Theory}
\label{chapter:Theory}

\section{Skin}

Cubic, Gaussean (sum from GPU gems),

Cristensebn-Burley falloffs 

\cite{EGWR:EGSR06:409-417} has formulas for the absorption and reduced scattering of the human skin. Also a lot of skin rendering results.

\section{The Diffusion Approximation}
Applies in highly scattering media: relation to the Central Limit Theorem
The approach underlying the application of diffusion approximations is comparable to that underlying normal approximation for
sums of random variables. In the latter setting, the central limit theorem
permits one to replace the analytically intractable sum of random variables by
an appropriately chosen normal random variable.

Main paper: A Practical Model for Subsurface Light Transport \cite{Jensen:2001:PMS:383259.383319}

Geometric assumption on the surface as a flat, semi-infinite slab at (any
point). This is reasonable only if scattering distance is small with respect to
surface curvature and thickness. \textbf{Multiple scattering} diffusion
component is approximately determined. The \textbf{single scattering} is
separately integrated.

Following: A Rapid Hierarchical Rendering Technique for Translucent Materials\\
\cite{Jensen:2002:RHR:566570.566619} Introduces the idea of decoupling the calculations of surface
illumination and the sub-surface scattering effect in a two-pass method;
describes a fast hierarchical approach for evaluating subsurface scattering
and proposes a reparametrization of the BSSRDF parameters for easier user adjustment.

Quantized diffusion \cite{D'Eon:2011:QMR:1964921.1964951} and
Improved diffusion \cite{Habel:2013:PBD:2600890.2600896} keeps the flat slab
assumption, but imploves multiple scattering approximation. The computation cost
is increased significantly.

\comment{I like the reasoning here}
Donner et al. in \cite{Donner:2009:EBM} claim that the sum of single scattering
simulation and diffusion approximation (isotropic multiple scattering) does not
able to capture materials with relatively large suspended particles (such as
orange juice or milk). Because of the significant amount of light in scattered
duirng to low-oreder scattering events and high absorbtion.
These materials exhibit significant absorption of the light as it propagates
through the material, so much of the energy is scattered back into
the environment near the point of incidence. This light exits in areas and
directions outside of the single scattering regime, but not in the high-order
multiple scattering regime.

In this work they use Monte Carlo particle tracing to tabulate an empirical
BSSRDF model for a flat surface on a homogeneous semi-infinite volume.
They represented the hemispherical distribution of light leaving the surface,
depending on the angle of the incident light, the relative position of the
exitant light, and the physical parameters (volume albedo, mean free path
length, phase function, and index of refraction). Their tables took months to
compute and contain around 250MB of data. (Still can't find thee data)

\section{Summary of \textbf{Classical and Improved Diffusion Theory for
Subsurface Scattering}}
Tech report from Habel et al. \cite{habel13cid} is similar to \cite{Habel:2013:PBD:2600890.2600896}
TODO: What is the difference
From Radiance Transport Equation {insert it here} to the integral equation which
computes the outgoing radiance, Lo, at position, direction (~ xo,~ wo) and
BSSRDF \textit{insest one here}


\section{Quantized-diffusion model}
\cite{D'Eon:2011:QMR:1964921.1964951}\\
\begin{itemize}
    \item Improved diffusion theory
    \item Extended source term instead of just a dipole
    \item More realistic look with sharper features
    \item Much more complicated and time-consuming to calculate (DO I WANT TO COMPARE PERFORMANCE?)
\end{itemize}
The resulting diffuse reflectance profile was approximated as a sum of Gaussians.

\section{Photon Beam diffusion}
The photon beam diffusion \cite{Habel:2013:PBD:2600890.2600896} had three main
contributions:
\begin{itemize}
    \item As accurate as quantized diffusion but much faster to evaluate,
    \item An accurate diffuse single-scattering model
    \item Elegant handling of oblique refraction into the material
\end{itemize}

\section{Cristensebn-Burley method}

First appear in \cite{Burley:disney_siggraph15}. Proposed fitting of the
diffusion profile on the basis of MC integration (multi+single):
\[
R_d(r) = \dfrac{e^{-r/d}+e^{-r/3d}}{8\pi dr}
\]
which is normalized over area and hemisphere:
\[
\int\limits_0^{2\pi}\int\limits_0^\infty R_d(r)rdrd\phi = 1
\]
The claimis Normalization -$>$ avoiding the need for albedo inversion. Why?

In the following paper \cite{Christensen:2015:ARP:2775280.2792555} shows simple
equations to relate parameter $d$ to the physical mean free path from radiative
transport. This model includes single scattering, so no expensive separate
calculation is needed.

CDF and inverted CDF are trivially derived, do importance sampling is not a
problem for this model. This requires sampling of each exponental separatly. RGB
also separated. Six Multiple Importance Samples in total.

Cons of the model:
\begin{itemize}
  \item {Still follows the infinite plane geometry assumption. So fails on
  large distance parameters. As all Diffusion approximation models}
  \item {Surface normals are not considered. Thay is why cavities are probles
  (without special treatment) and bump details are blurried}
  \item{Quote: \textit{Sampling can be difficult and expensive. Diffusion
  integration requires distributing samples over the entire surface with known
  density, preferably proportional to the diffusion profile. We can generate
  such samples within a plane, but projecting this density through a solid can
  oversample some parts of the surface and undersample others. Using MIS between
  multiple planes [KKCF13] helps prevent undersampling but oversampling is still
  a problem. Each plane sample also requires ray probing to find surface hits,
  and if there are multiple intersections we build a conditional CDF based on
  the distance to each point, then stochastically choose a point to sample. The
  per-sample cost is substantial}}
\end{itemize}

Chistensen-Burley model is implemented in the newest Cycles.