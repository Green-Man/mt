\chapter{Theory}
\label{chapter:theory}

\section{Monte Carlo methods}
\label{Monte-Carlo}
\cite{Lafortune:1996:RPM:275458.275468} has short but decent description of the integrals on the
surface and in the media to integrate using with Monte Carlo approach.
A nice picture explaining BDPT is also there.

\gls{MIS} overview.
\subsection{Importance sampling}
\label{ImportanceSampling}
\emph{In order to reduce variance,  it is desirable to importance sample reflected rays by
preferentially considering paths carrying high energy.} \emph{The benefit of stratified importance
sampling  within  the  context  of  physically-based rendering  has  certainly  been  justified by 
the  work  of Cook  [1986].   Since  Shirley demonstrated  how  to  efficiently  sample  the 
traditional  Phong BRDF  [Shirley  1990]  and Lafortune  introduced  a  generalization of  this 
cosine-lobe  model  [Lafortune  et  al.  1997], a  reasonable approach to importance sampling an
arbitrary BRDF has been to sample  a  best-fit approximation  of  one  of  these  simpler  models.
Although this technique marks a clear improvement over random sampling,  it has several drawbacks.
First, it is not always trivial to approximate the many complex BRDFs that exist in nature with one
of these models.}

\subsection{Russian roulette}
\label{subsection:rr}
Not a variance reduction in mathematical sense. Strictly speaking, it it even
increases the variance of the estimator. But reduces to cost of sampling in
average \cite{Veach:1998:RMC:927297}, \cite{Csi03variancereduction}

Russian roulette is an indispensable technique in transport calculations, since it allows otherwise
infinite random walks to be terminated without bias \cite{Veach:1998:RMC:927297}

\ldots

\section{Light simulation in participating media}
\label{section:light_simulation_theory}
\subsection{Emission, Absorption and Scattering}

\subsection{Isotropic and Anisotropic phase functions}
\label{section:phasefunction}

The simplest isotropic phase function i.e. the probability density of the scattering in the given
direction has the form:
\[
p(\Theta) = \frac{1}{4\pi}
\]
which of course does not depends on the angel and is constant in any direction.

The form of the phase function in the anisotropic scattering becomes more complex. The number of
sources have shown \cite{0031-9155-51-17-N04}, \cite{Gkioulekas:2013:URP:2516971.2516972} that the
Heynye-Greenstein function fits reasonably well for approximation complex phase function of many
organic or artificial materials:
\begin{align}
\label{eq:hg_pdf_theory}
p(\Theta) = \frac{1}{4\pi}\cdot\frac{1-g^2}{1+g^2-2g(\cos{\Theta})^{3/2}}
\end{align}
where $\Theta$ is an angle between incident and scattered directions of the particle, $g$ is the
anisotropy factor. $g$ has it's values in the range from -1 to 1 for back or front scattering
materials respectively. The anisotropy factor describes the characteristic number of the scattering
events after which the information of the initial incident direction is lost
\cite{wang2007biomedical}.

Even though there is a common approximation for reduced scattering coefficient:
\[
\sigma\prime_s = \sigma_s(1 - g)
\]
the sections regarding Diffusion Approximation in this work only describe rendering of the isotropic
materials.

Despite the fact that Heynye-Greenstein phase function is widely used in many rendering application
the work \cite{Gkioulekas:2013:IVR:2508363.2508377} showed a big user study pointing some failing
cases of this approximation due to the lack of generality of the Heynye-Greenstein function. Another
conclusion from this research is that anisotropy parameter has higly non-linear effect on the
rendered output and it suggested to be exposed to the users as $g^2$.

\input{chapters/theory/diffusion_approximation}