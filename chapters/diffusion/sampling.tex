\section{Sampling methods}
\label{sampling_methods}
\begin{itemize}
    \item{Infinite plane disk sampling \cite{Jensen:2001:PMS:383259.383319}}
    \item{Multiresolution radiosity caching \cite{Christensen:2012:MRC:2343045.2343108}}
    \item{Bidirectional Lightcuts \cite{Walter:2012:BL:2185520.2185555}}
    \item{Improved disk sampling \cite{King:2013:BIS:2504459.2504520}}
\end{itemize}

The planar geometry assumption, described in the section \ref{section:BSSRDF_intuition} on the 
basics of BSSRDF and section \ref{section:searchlight} on the  Searchlight experiment, make it
trivial to sample the area around the shading point to integrate light contribution. Original
approach described in \cite{Jensen:2001:PMS:383259.383319} for integration of the BSSRDF produce
very good approximation if the geometry is locally flat. The approach is based on the sampling the
area of the disk located with it's center in the current shading point and oriented by normal to the
surface. The naive approach would utilize the uniform distribution of samples over the area of the
disk. Then, the light contribution $L$ is estimated by tracing the shadow ray to the light source
and modulated by the BSSRDF value taking into account the distance $r$ between center of the disk
and sampling position. \comment{Image with the infinite plane disk sampling} This sampling technique
produce very good approximation in case of the flat infinite plane. But fails in any case of
non-planar geometry. \comment{Image with failing cases of naive disk sampling}

A number of sampling techniques where proposed in the literature to improve handling of complex
geometries. The description of the most modern of them is given below. But yet non of them are
robust enough to integrate the BSSRDF on models with high curvatures with good accuracy.

\subsection{Multiple disk sampling}
Described in \cite{King:2013:BIS:2504459.2504520} the advanced disk sampling technique can be seen
as an extension of the classic disc sampling method.

First improvement is introduced by finding the actual point on the geometry instead of casting
the shadow rays from the virtual disk surface. This can be done by casting a short rays with the
origin at the disk, shifted along the shading normal, in the direction of the negative normal.
\comment{image the local short ray tracing} This ray tracing procedure indeed increase the
computation time of the BSSRDF sampling. But the modern ray tracing engines allow to
preform very efficient ray-geometry intersection tests for short rays with locally bounded
geometries. The fact, that there is no need to traverse the whole scene greatly improves the
performance of such sampling.

The next step in increasing robustness of the disk sampling integration technique is done by using
three disk samples instead of one and aligning the axes of the disk along the local orthonormal
basis $(n,s,t)$ of the geometry in the point of shading. \comment{picture with three disks}
According to \cite{King:2013:BIS:2504459.2504520}, the usual normal aligned disk is weighted with
0.5 probability. The $s$ and $t$ aligned disk samples has 0.25 contribution. The multiple importance
sampling combination of this this three disk samples allows to greatly increase the performance of
the BSSRDG integration.\comment{TODO: show equal time comparison}

\emph{Quote \cite{Burley:disney_siggraph15}: Sampling can be difficult and expensive. Diffusion
integration requires distributing samples over the entire surface with known
density, preferably proportional to the diffusion profile. We can generate
such samples within a plane, but projecting this density through a solid may
lead to oversampling of some parts of the surface and undersampling of the
others.
Using MIS between multiple planes \cite{King:2013:BIS:2504459.2504520}  helps prevent
undersampling but oversampling is still a problem. Each plane sample also
requires ray probing to find surface hits, and if there are multiple
intersections we build a conditional CDF based on the distance to each point,
then stochastically choose a point to sample.}